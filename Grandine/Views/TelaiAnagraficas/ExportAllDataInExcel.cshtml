@model IEnumerable<Grandine.Models.TelaiAnagraficaFlat_vw>

@{
    ViewBag.Title = "ExportAllDataInExcel";
}




<head>

    <script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.21/b-1.6.2/b-colvis-1.6.2/b-flash-1.6.2/b-html5-1.6.2/b-print-1.6.2/cr-1.5.2/fc-3.3.1/fh-3.1.7/kt-2.5.2/r-2.2.5/rg-1.1.2/rr-1.2.7/sc-2.0.2/sp-1.1.1/sl-1.3.1/datatables.min.css" />

    <script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.21/b-1.6.2/b-colvis-1.6.2/b-flash-1.6.2/b-html5-1.6.2/b-print-1.6.2/cr-1.5.2/fc-3.3.1/fh-3.1.7/kt-2.5.2/r-2.2.5/rg-1.1.2/rr-1.2.7/sc-2.0.2/sp-1.1.1/sl-1.3.1/datatables.min.js"></script>
    <script type="text/javascript" src=" https://cdn.datatables.net/buttons/1.6.4/js/dataTables.buttons.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.6.4/js/buttons.flash.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script type="text/javascript" src=" https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script type="text/javascript" src=" https://cdn.datatables.net/buttons/1.6.4/js/buttons.html5.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/buttons/1.6.4/js/buttons.print.min.js"></script>

</head>



@Styles.Render("~/Content/mygrid.css")
<br />
<div>
    @Html.ActionLink("Torna a lista", "Index", new { IDCommessa = Session["IDCommessa"] }, new { @class = "btn btn-primary" })
</div>
<br /><br />
<table id="example" class="display" style="width:100%">
    <thead>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.Telaio)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Modello)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Targa)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.InsertUser)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.InsertDate)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NomeFile)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IDCommessa)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Commessa)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Annotazioni)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataIn)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataOut)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NFattAttiva)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataFattAtt)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ImpFattAtt)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Tecnico)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NumFattTecnico)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataFatturaPassiva)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ImportoFattPass)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Carrozzeria_1)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NumFattCarrozzeria1)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataFatturaCarrozzeria1)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ImportoCarrozzeria1)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IDCarrozzeria2)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Carrozzera_2)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NumFattCarrozzeria2)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataFatturaCarrozzeria2)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ImportoCarrozzeria2)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IDCarrozzeria3)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Carrozzeria_3)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NumFattCarrozzeria3)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataFatturaCarrozzeria3)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ImportoCarrozzeria3)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IDCarglass)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.CarGlass)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NumFattCarGlass)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ImportoFattCarGlass)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataFatturaCarglass)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IDBisarchistaAndata)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.BisarchistaAndata)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NumFattBisarchistaA)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataFattBisarchistaA)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.CostoAndata)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IDBisarchistaRitorno)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.BisarchistaRitorno)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NumFattBisarchistaR)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataFattBisarchistaR)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.CostoRitorno)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Costi)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Chiave)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Fila)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IDGravita)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Gravita)
            </th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.Telaio)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Modello)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Targa)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.InsertUser)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.InsertDate)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.NomeFile)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.IDCommessa)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Commessa)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Annotazioni)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.DataIn)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.DataOut)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.NFattAttiva)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.DataFattAtt)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ImpFattAtt)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Tecnico)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.NumFattTecnico)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.DataFatturaPassiva)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ImportoFattPass)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Carrozzeria_1)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.NumFattCarrozzeria1)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.DataFatturaCarrozzeria1)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ImportoCarrozzeria1)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.IDCarrozzeria2)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Carrozzera_2)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.NumFattCarrozzeria2)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.DataFatturaCarrozzeria2)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ImportoCarrozzeria2)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.IDCarrozzeria3)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Carrozzeria_3)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.NumFattCarrozzeria3)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.DataFatturaCarrozzeria3)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ImportoCarrozzeria3)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.IDCarglass)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.CarGlass)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.NumFattCarGlass)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ImportoFattCarGlass)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.DataFatturaCarglass)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.IDBisarchistaAndata)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.BisarchistaAndata)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.NumFattBisarchistaA)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.DataFattBisarchistaA)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.CostoAndata)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.IDBisarchistaRitorno)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.BisarchistaRitorno)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.NumFattBisarchistaR)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.DataFattBisarchistaR)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.CostoRitorno)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Costi)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Chiave)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Fila)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.IDGravita)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Gravita)
            </td>
        </tr>
        }
    </tbody>
    <tfoot>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.Telaio)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Modello)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Targa)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.InsertUser)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.InsertDate)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NomeFile)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IDCommessa)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Commessa)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Annotazioni)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataIn)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataOut)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NFattAttiva)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataFattAtt)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ImpFattAtt)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Tecnico)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NumFattTecnico)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataFatturaPassiva)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ImportoFattPass)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Carrozzeria_1)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NumFattCarrozzeria1)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataFatturaCarrozzeria1)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ImportoCarrozzeria1)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IDCarrozzeria2)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Carrozzera_2)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NumFattCarrozzeria2)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataFatturaCarrozzeria2)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ImportoCarrozzeria2)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IDCarrozzeria3)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Carrozzeria_3)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NumFattCarrozzeria3)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataFatturaCarrozzeria3)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ImportoCarrozzeria3)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IDCarglass)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.CarGlass)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NumFattCarGlass)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.ImportoFattCarGlass)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataFatturaCarglass)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IDBisarchistaAndata)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.BisarchistaAndata)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NumFattBisarchistaA)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataFattBisarchistaA)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.CostoAndata)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IDBisarchistaRitorno)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.BisarchistaRitorno)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.NumFattBisarchistaR)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.DataFattBisarchistaR)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.CostoRitorno)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Costi)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Chiave)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Fila)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.IDGravita)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Gravita)
            </th>
        </tr>
    </tfoot>

</table>

<script>
    $(document).ready(function () {
        var table = $('#ElencoTelai').DataTable({
            "autoWidth": false,
            stateSave: true,
            "lengthMenu": [[10, 50, 100, -1], [10, 50, 100, "Tutti"]],
            "iDisplayLength": 50,
            buttons: [

                {
                    extend: 'excelHtml5',
                    text: 'Crea excel',
                    exportOptions: {
                        modifier: {
                            search: 'none'
                        }
                    }
                }
                ,
                {
                    extend: 'print',
                    text: 'Stampa griglia',
                    exportOptions: {
                        modifier: {
                            search: 'none'
                        }
                    }
                }
                ,
                {
                    extend: 'pdf',
                    text: 'Crea PDF',
                    exportOptions: {
                        modifier: {
                            search: 'none'
                        }
                    }
                }
            ],


            dom: 'Blfrtip',
            //buttons: [
            //    'copy', 'csv', 'excel',  'print'
            //],
            "columnDefs": [
                { "width": "110px", "targets": 0 },
                { "width": "40px", "targets": 1 },
                { "width": "100px", "targets": 2 },
                { "width": "70px", "targets": 3 },
                { "width": "270px", "targets": 4 },
                { "width": "70px", "targets": 5 }
            ],
            //stateSave: true,
            language: {

                processing: "Ricerca in corso...",
                search: "Ricerca:",
                //lengthMenu: "Visualizza _MENU_ elementi",

                info: "Elenca da _START_ a _END_ di _TOTAL_ elementi",
                infoEmpty: "Elenca da 0 a 0 di 0 elementi",
                infoFiltered: "(filtrati da _MAX_ elementi totali)",
                infoPostFix: "",
                loadingRecords: "Caricamento...",
                zeroRecords: "La ricerca non ha portato alcun risultato.",
                emptyTable: "Nessun record presente in tabella",
                paginate: {
                    first: "Inizio",
                    previous: "Precedente",
                    next: "Successivo",
                    last: "Fine"
                },
                aria: {
                    sortAscending: ": attiva per ordinare la colonna in ordine crescente",
                    sortDescending: ": attiva per ordinare la colonna in ordine decrescente"
                },
                searchPanes: {
                    title: {
                        _: 'Filtri selezionati : %d',
                        0: 'Nessun filtro selezionato',
                        1: 'Un solo filtro selezionato'
                    },
                    clearMessage: 'Azzera filtri !',
                    collapse: { 0: 'Ricerca avanzata', _: 'Scelte selezionate (%d)' }
                },
                buttons: [
                    'copy', 'csv', 'excel', 'print'
                ]
            }
        });
    });

</script>

<script>
    $(document).ready(function () {
        $('#example').DataTable({
            dom: 'Brti',
            buttons: [
                 'excel'
            ]
        });
    });
</script>